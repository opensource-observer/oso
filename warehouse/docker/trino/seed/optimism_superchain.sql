CREATE SCHEMA IF NOT EXISTS bigquery.optimism_superchain_4337_account_abstraction_data;

CREATE SCHEMA IF NOT EXISTS bigquery.optimism_superchain_raw_onchain_data;

CREATE TABLE IF NOT EXISTS bigquery.optimism_superchain_4337_account_abstraction_data.enriched_entrypoint_traces_v2 (
   chain_id bigint,
   network varchar,
   block_timestamp bigint,
   block_number bigint,
   block_hash varchar,
   transaction_hash varchar,
   transaction_index bigint,
   from_address varchar,
   to_address varchar,
   value varchar,
   input varchar,
   output varchar,
   trace_type varchar,
   call_type varchar,
   reward_type varchar,
   gas bigint,
   gas_used bigint,
   subtraces bigint,
   trace_address varchar,
   error varchar,
   status bigint,
   trace_root bigint,
   method_id varchar,
   tx_from_address varchar,
   bundler_address varchar,
   entrypoint_contract_address varchar,
   entrypoint_contract_version varchar,
   innerhandleop_trace_address varchar,
   is_innerhandleop boolean,
   is_from_sender boolean,
   userop_sender varchar,
   userop_paymaster varchar,
   userop_hash varchar,
   userop_calldata varchar,
   innerhandleop_decodeerror varchar,
   innerhandleop_opinfo varchar,
   innerhandleop_context varchar,
   useropevent_nonce varchar,
   useropevent_success boolean,
   useropevent_actualgascost varchar,
   useropevent_actualgasused varchar,
   userop_idx bigint,
   useropevent_actualgascost_eth double,
   chain varchar,
   dt date
);

INSERT INTO
   bigquery.optimism_superchain_4337_account_abstraction_data.enriched_entrypoint_traces_v2
VALUES
   (
      1,
      'network1',
      1622547800,
      123456,
      'block_hash1',
      'tx_hash1',
      1,
      'from_address1',
      'to_address1',
      'value1',
      'input1',
      'output1',
      'trace_type1',
      'call_type1',
      'reward_type1',
      21000,
      20000,
      1,
      'trace_address1',
      'error1',
      1,
      1,
      'method_id1',
      'tx_from_address1',
      'bundler_address1',
      'entrypoint_contract_address1',
      'v1',
      'trace_address1',
      true,
      true,
      'userop_sender1',
      'userop_paymaster1',
      'userop_hash1',
      'userop_calldata1',
      'decodeerror1',
      'opinfo1',
      'context1',
      'nonce1',
      true,
      'actualgascost1',
      'actualgasused1',
      1,
      0.01,
      'chain1',
      current_date - interval '1' day
   ),
   (
      2,
      'network2',
      1622547801,
      123457,
      'block_hash2',
      'tx_hash2',
      2,
      'from_address2',
      'to_address2',
      'value2',
      'input2',
      'output2',
      'trace_type2',
      'call_type2',
      'reward_type2',
      22000,
      21000,
      2,
      'trace_address2',
      'error2',
      2,
      2,
      'method_id2',
      'tx_from_address2',
      'bundler_address2',
      'entrypoint_contract_address2',
      'v2',
      'trace_address2',
      false,
      false,
      'userop_sender2',
      'userop_paymaster2',
      'userop_hash2',
      'userop_calldata2',
      'decodeerror2',
      'opinfo2',
      'context2',
      'nonce2',
      false,
      'actualgascost2',
      'actualgasused2',
      2,
      0.02,
      'chain2',
      current_date
   );

CREATE TABLE IF NOT EXISTS bigquery.optimism_superchain_4337_account_abstraction_data.useroperationevent_logs_v2 (
   chain_id bigint,
   network varchar,
   block_timestamp bigint,
   block_number bigint,
   block_hash varchar,
   transaction_hash varchar,
   transaction_index bigint,
   log_index bigint,
   contract_address varchar,
   userophash varchar,
   sender varchar,
   paymaster varchar,
   nonce varchar,
   success boolean,
   actualgascost varchar,
   actualgasused varchar,
   chain varchar,
   dt date
);

INSERT INTO
   bigquery.optimism_superchain_4337_account_abstraction_data.useroperationevent_logs_v2
VALUES
   (
      1,
      'network1',
      1622547800,
      123456,
      'block_hash1',
      'tx_hash1',
      1,
      1,
      'contract_address1',
      'userophash1',
      'sender1',
      'paymaster1',
      'nonce1',
      true,
      'actualgascost1',
      'actualgasused1',
      'chain1',
      current_date - interval '1' day
   ),
   (
      2,
      'network2',
      1622547801,
      123457,
      'block_hash2',
      'tx_hash2',
      2,
      2,
      'contract_address2',
      'userophash2',
      'sender2',
      'paymaster2',
      'nonce2',
      false,
      'actualgascost2',
      'actualgasused2',
      'chain2',
      current_date
   );

CREATE TABLE IF NOT EXISTS bigquery.optimism_superchain_raw_onchain_data.blocks (
   network varchar,
   chain_id bigint,
   timestamp bigint,
   number bigint,
   hash varchar,
   parent_hash varchar,
   nonce varchar,
   sha3_uncles varchar,
   logs_bloom varchar,
   transactions_root varchar,
   state_root varchar,
   receipts_root varchar,
   withdrawals_root varchar,
   miner varchar,
   difficulty double,
   total_difficulty double,
   size bigint,
   base_fee_per_gas bigint,
   gas_used bigint,
   gas_limit bigint,
   extra_data varchar,
   transaction_count bigint,
   chain varchar,
   dt date
);

INSERT INTO
   bigquery.optimism_superchain_raw_onchain_data.blocks
VALUES
   (
      'network1',
      1,
      1622547800,
      123456,
      'hash1',
      'parent_hash1',
      'nonce1',
      'sha3_uncles1',
      'logs_bloom1',
      'transactions_root1',
      'state_root1',
      'receipts_root1',
      'withdrawals_root1',
      'miner1',
      1.0,
      1.0,
      1,
      1,
      1,
      1,
      'extra_data1',
      1,
      'chain1',
      current_date - interval '1' day
   ),
   (
      'network2',
      2,
      1622547801,
      123457,
      'hash2',
      'parent_hash2',
      'nonce2',
      'sha3_uncles2',
      'logs_bloom2',
      'transactions_root2',
      'state_root2',
      'receipts_root2',
      'withdrawals_root2',
      'miner2',
      2.0,
      2.0,
      2,
      2,
      2,
      2,
      'extra_data2',
      2,
      'chain2',
      current_date
   );

CREATE TABLE IF NOT EXISTS bigquery.optimism_superchain_raw_onchain_data.traces (
   network varchar,
   chain_id bigint,
   block_timestamp bigint,
   block_number bigint,
   block_hash varchar,
   transaction_hash varchar,
   transaction_index bigint,
   from_address varchar,
   to_address varchar,
   value_64 bigint,
   value_lossless varchar,
   input varchar,
   output varchar,
   trace_type varchar,
   call_type varchar,
   reward_type varchar,
   gas bigint,
   gas_used bigint,
   subtraces bigint,
   trace_address varchar,
   error varchar,
   status bigint,
   chain varchar,
   dt date
);

INSERT INTO
   bigquery.optimism_superchain_raw_onchain_data.traces
VALUES
   (
      'network1',
      1,
      1622547800,
      123456,
      'block_hash1',
      'tx_hash1',
      1,
      'from_address1',
      'to_address1',
      1,
      'value_lossless1',
      'input1',
      'output1',
      'trace_type1',
      'call_type1',
      'reward_type1',
      21000,
      20000,
      1,
      'trace_address1',
      'error1',
      1,
      'chain1',
      current_date - interval '1' day
   ),
   (
      'network2',
      2,
      1622547801,
      123457,
      'block_hash2',
      'tx_hash2',
      2,
      'from_address2',
      'to_address2',
      2,
      'value_lossless2',
      'input2',
      'output2',
      'trace_type2',
      'call_type2',
      'reward_type2',
      22000,
      21000,
      2,
      'trace_address2',
      'error2',
      2,
      'chain2',
      current_date
   );

CREATE TABLE IF NOT EXISTS bigquery.optimism_superchain_raw_onchain_data.transactions (
   network varchar,
   chain_id bigint,
   block_timestamp bigint,
   block_number bigint,
   block_hash varchar,
   hash varchar,
   nonce bigint,
   transaction_index bigint,
   from_address varchar,
   to_address varchar,
   value_64 bigint,
   value_lossless varchar,
   gas bigint,
   gas_price bigint,
   input varchar,
   transaction_type bigint,
   max_fee_per_gas bigint,
   max_priority_fee_per_gas bigint,
   receipt_cumulative_gas_used bigint,
   receipt_gas_used bigint,
   receipt_contract_address varchar,
   receipt_status bigint,
   receipt_effective_gas_price bigint,
   receipt_l1_gas_price bigint,
   receipt_l1_gas_used bigint,
   receipt_l1_fee bigint,
   receipt_l1_fee_scalar double,
   receipt_l1_blob_base_fee bigint,
   receipt_l1_blob_base_fee_scalar bigint,
   receipt_l1_base_fee_scalar bigint,
   chain varchar,
   dt date
);

INSERT INTO
   bigquery.optimism_superchain_raw_onchain_data.transactions
VALUES
   (
      'network1',
      1,
      1622547800,
      123456,
      'block_hash1',
      'hash1',
      1,
      1,
      'from_address1',
      'to_address1',
      1,
      'value_lossless1',
      21000,
      1,
      'input1',
      1,
      1,
      1,
      1,
      1,
      'receipt_contract_address1',
      1,
      1,
      1,
      1,
      1,
      1.0,
      1,
      1,
      1,
      'chain1',
      current_date - interval '1' day
   ),
   (
      'network2',
      2,
      1622547801,
      123457,
      'block_hash2',
      'hash2',
      2,
      2,
      'from_address2',
      'to_address2',
      2,
      'value_lossless2',
      22000,
      2,
      'input2',
      2,
      2,
      2,
      2,
      2,
      'receipt_contract_address2',
      2,
      2,
      2,
      2,
      2,
      2.0,
      2,
      2,
      2,
      'chain2',
      current_date
   );