test_int_events_aux_prs_since_20251007_basic:
  model: oso.int_events_aux_prs_since_20251007
  vars:
    start_dt: 2025-10-07
    end_dt: 2025-10-10
  inputs:
    oso.stg_github__pull_requests_since_20251007:
      columns:
        created_at: timestamp(6)
        event_time: timestamp(6)
        closed_at: timestamp(6)
        merged_at: timestamp(6)
      rows:
      - id: "pr_event_1"
        event_time: "2025-10-07 14:00:00.000000"
        repository_id: 12345
        repository_name: "owner1/repo1"
        actor_id: 1001
        actor_login: "user1"
        type: "PULL_REQUEST_OPENED"
        number: 1
        created_at: "2025-10-07 14:00:00.000000"
        merged_at: null
        closed_at: null
        state: "open"
        comments: 0
        author_association: "FIRST_TIME_CONTRIBUTOR"
      - id: "pr_event_2"
        event_time: "2025-10-08 10:00:00.000000"
        repository_id: 12345
        repository_name: "owner1/repo1"
        actor_id: 1002
        actor_login: "user2"
        type: "PULL_REQUEST_OPENED"
        number: 2
        created_at: "2025-10-08 10:00:00.000000"
        merged_at: null
        closed_at: null
        state: "open"
        comments: 0
        author_association: "MEMBER"
    oso.stg_github__pull_request_merge_events_since_20251007:
      columns:
        id: text
        event_time: timestamp(6)
        repository_id: bigint
        repository_name: text
        actor_id: bigint
        actor_login: text
        type: text
        number: bigint
        created_at: timestamp(6)
        merged_at: timestamp(6)
        closed_at: timestamp(6)
        state: text
        merge_commit_sha: text
        changed_files: int
        additions: int
        deletions: int
        review_comments: double
        comments: double
        author_association: text
      rows:
      - id: "pr_merge_event_1"
        event_time: "2025-10-09 16:00:00.000000"
        repository_id: 12345
        repository_name: "owner1/repo1"
        actor_id: 1001
        actor_login: "user1"
        type: "PULL_REQUEST_MERGED"
        number: 1
        created_at: "2025-10-07 14:00:00.000000"
        merged_at: null
        closed_at: null
        state: "closed"
        merge_commit_sha: "abc123def456"
        changed_files: null
        additions: null
        deletions: null
        review_comments: null
        comments: 2
        author_association: null
    oso.stg_github__comments_since_20251007:
      columns:
        created_at: timestamp(6)
        event_time: timestamp(6)
        closed_at: timestamp(6)
        merged_at: timestamp(6)
      rows:
      - id: "pr_comment_event_1"
        event_time: "2025-10-07 18:30:00.000000"
        repository_id: 12345
        repository_name: "owner1/repo1"
        actor_id: 1004
        actor_login: "user4"
        type: "PULL_REQUEST_REVIEW_COMMENT"
        number: 1
        created_at: "2025-10-07 14:00:00.000000"
        merged_at: null
        closed_at: null
        state: "open"
        comments: 1
      - id: "pr_comment_event_2"
        event_time: "2025-10-08 12:15:00.000000"
        repository_id: 12345
        repository_name: "owner1/repo1"
        actor_id: 1005
        actor_login: "user5"
        type: "PULL_REQUEST_COMMENT"
        number: 2
        created_at: "2025-10-08 10:00:00.000000"
        merged_at: null
        closed_at: null
        state: "open"
        comments: 1
  outputs:
    query:
      partial: true
      rows:
      - time: "2025-10-07 14:00:00.000000"
        pr_number: 1
        created_at: "2025-10-07 14:00:00.000000"
        merged_at: null
        closed_at: null
        comments: 0
        author_association: "FIRST_TIME_CONTRIBUTOR"
        event_type: "PULL_REQUEST_OPENED"
        event_source_id: "pr_event_1"
        event_source: "GITHUB"
      - time: "2025-10-07 18:30:00.000000"
        pr_number: 1
        created_at: "2025-10-07 14:00:00.000000"
        merged_at: null
        closed_at: null
        comments: 1
        author_association: null
        event_type: "PULL_REQUEST_REVIEW_COMMENT"
        event_source_id: "pr_comment_event_1"
        event_source: "GITHUB"
      - time: "2025-10-08 10:00:00.000000"
        pr_number: 2
        created_at: "2025-10-08 10:00:00.000000"
        merged_at: null
        closed_at: null
        comments: 0
        author_association: "MEMBER"
        event_type: "PULL_REQUEST_OPENED"
        event_source_id: "pr_event_2"
        event_source: "GITHUB"
      - time: "2025-10-08 12:15:00.000000"
        pr_number: 2
        created_at: "2025-10-08 10:00:00.000000"
        merged_at: null
        closed_at: null
        comments: 1
        author_association: null
        event_type: "PULL_REQUEST_COMMENT"
        event_source_id: "pr_comment_event_2"
        event_source: "GITHUB"
      - time: "2025-10-09 16:00:00.000000"
        pr_number: 1
        created_at: "2025-10-07 14:00:00.000000"
        merged_at: null
        closed_at: null
        comments: 2
        author_association: null
        event_type: "PULL_REQUEST_MERGED"
        event_source_id: "pr_merge_event_1"
        event_source: "GITHUB"
