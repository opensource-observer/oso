test_stg_github__pull_request_merge_events_since_20251007_basic:
  model: oso.stg_github__pull_request_merge_events_since_20251007
  vars:
    start_dt: 2025-10-07
    end_dt: 2025-10-08
  inputs:
    oso.stg_github__events:
      columns:
        id: text
        type: text
        created_at: timestamp
        repo: STRUCT(id BIGINT, name VARCHAR, url VARCHAR)
        actor: STRUCT(id BIGINT, login VARCHAR, avatar_url VARCHAR, url VARCHAR)
        payload: text
      rows:
      - id: "event_1"
        type: "PullRequestEvent"
        created_at: "2025-10-07 10:00:00"
        repo:
          id: 123
          name: "owner/repo"
          url: "url"
        actor:
          id: 555
          login: "user1"
          avatar_url: "url"
          url: "url"
        payload: |
          {
            "action": "closed",
            "number": 1,
            "pull_request": {
              "id": 1001,
              "user": {
                "id": 555,
                "login": "user1"
              },
              "merge_commit_sha": "abc123sha"
            }
          }
      - id: "event_2"
        type: "PullRequestEvent"
        created_at: "2025-10-07 11:00:00"
        repo:
          id: 123
          name: "owner/repo"
          url: "url"
        actor:
          id: 555
          login: "user1"
          avatar_url: "url"
          url: "url"
        payload: |
          {
            "action": "opened",
            "number": 2,
            "pull_request": {
              "id": 1002
            }
          }
  outputs:
    query:
      rows:
      - repository_id: 123
        repository_name: "owner/repo"
        type: "PULL_REQUEST_MERGED"
        id: "1001"
        event_time: "2025-10-07 10:00:00"
        merged_at: null
        created_at: "2025-10-07 10:00:00"
        closed_at: null
        actor_id: 555
        actor_login: "user1"
        state: null
        merge_commit_sha: "abc123sha"
        changed_files: null
        additions: null
        deletions: null
        review_comments: null
        comments: null
        author_association: null
        number: 1