test_int_events__github_basic:
  model: oso.int_events__github
  vars:
    start_dt: 2024-01-01
    end_dt: 2024-01-02
  inputs:
    oso.stg_github__distinct_commits_resolved_mergebot:
      columns:
        created_at: timestamp(6)
      rows:
      - repository_id: 101
        sha: "sha1"
        created_at: "2024-01-01 10:00:00.000000"
        repository_name: "owner/repo"
        push_id: 123
        actor_id: 555
        actor_login: "user1"
        author_email: "u1@mail"
    oso.stg_github__releases:
      columns:
        created_at: timestamp(6)
      rows: []
    oso.stg_github__comments:
      columns:
        closed_at: timestamp(6)
        created_at: timestamp(6)
        event_time: timestamp(6)
        merged_at: timestamp(6)
      rows: []
    oso.stg_github__issues:
      columns:
        closed_at: timestamp(6)
        created_at: timestamp(6)
        event_time: timestamp(6)
      rows: []
    oso.stg_github__pull_requests:
      columns:
        closed_at: timestamp(6)
        created_at: timestamp(6)
        event_time: timestamp(6)
        merged_at: timestamp(6)
      rows: []
    oso.stg_github__pull_request_merge_events:
      columns:
        event_time: timestamp(6)
        created_at: timestamp(6)
        merged_at: timestamp(6)
        closed_at: timestamp(6)
      rows:
      - repository_id: 101
        id: "ev1"
        type: "PULL_REQUEST_MERGED"
        event_time: "2024-01-01 12:00:00.000000"
        repository_name: "owner/repo"
        actor_id: 555
        actor_login: "user1"
    oso.stg_github__stars_and_forks:
      columns:
        created_at: timestamp(6)
      rows: []
  outputs:
    query:
      rows:
      - time: "2024-01-01 10:00:00.000000"
        to_artifact_name: "repo"
        to_artifact_namespace: "owner"
        to_artifact_source_id: "101"
        to_artifact_id: "d67f26aa76a0fc7e0e59e72461ba23ae60d57a0f148e0341ec9da1eeb37e8a22"
        from_artifact_name: "user1"
        from_artifact_namespace: "user1"
        from_artifact_source_id: "555"
        from_artifact_id: "3d37ccdc4b332167e08948b0360d23d9ddbbd607df3dbcdacd0ad7a250ae0003"
        event_type: "COMMIT_CODE"
        event_source_id: "123"
        event_source: "GITHUB"
        amount: 1.0
      - time: "2024-01-01 12:00:00.000000"
        to_artifact_name: "repo"
        to_artifact_namespace: "owner"
        to_artifact_source_id: "101"
        to_artifact_id: "d67f26aa76a0fc7e0e59e72461ba23ae60d57a0f148e0341ec9da1eeb37e8a22"
        from_artifact_name: "user1"
        from_artifact_namespace: "user1"
        from_artifact_source_id: "555"
        from_artifact_id: "3d37ccdc4b332167e08948b0360d23d9ddbbd607df3dbcdacd0ad7a250ae0003"
        event_type: "PULL_REQUEST_MERGED"
        event_source_id: "ev1"
        event_source: "GITHUB"
        amount: 1.0
