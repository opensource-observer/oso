test_int_opendevdata__commits_with_repo_id:
  model: oso.int_opendevdata__commits_with_repo_id
  inputs:
    oso.stg_opendevdata__commits:
      rows:
        - id: 1
          repo_id: 10
          sha1: "sha1"
          created_at: "2024-01-01 00:00:00"
          additions: 10
          deletions: 5
          authored_at: "2024-01-01 00:00:00"
          authored_at_offset: 0
          committed_at: "2024-01-01 00:00:00"
          committed_at_offset: 0
          commit_author_name: "Dev1"
          commit_author_email: "dev1@example.com"
          canonical_developer_id: 1
          is_bot: 0
        - id: 2
          repo_id: 10
          sha1: "sha2"
          created_at: "2024-01-01 00:00:00"
          additions: 20
          deletions: 10
          authored_at: "2024-01-01 00:00:00"
          authored_at_offset: 0
          committed_at: "2024-01-01 00:00:00"
          committed_at_offset: 0
          commit_author_name: "Dev1"
          commit_author_email: "dev1@example.com"
          canonical_developer_id: 1
          is_bot: 0
        - id: 3
          repo_id: 20
          sha1: "sha3"
          created_at: "2024-01-01 00:00:00"
          additions: 5
          deletions: 0
          authored_at: "2024-01-01 00:00:00"
          authored_at_offset: 0
          committed_at: "2024-01-01 00:00:00"
          committed_at_offset: 0
          commit_author_name: "Dev2"
          commit_author_email: "dev2@example.com"
          canonical_developer_id: 2
          is_bot: 0

    oso.int_opendevdata__repositories_with_repo_id:
      rows:
        - opendevdata_id: 10
          repo_id: 100
          repo_name: "test/repo"
          github_graphql_id: "node_1"
          star_count: 50
          fork_count: 10
          repo_created_at: "2020-01-01"
          repo_id_source: "ossd"
          is_opendevdata_blacklist: false

    oso.int_github__commits_all:
      rows:
        - sha: "sha1"
          repository_id: 1000
          repository_name: "test/repo"
          created_at: "2024-01-01 00:00:00"
          push_id: 123
          ref: "refs/heads/main"
          actor_id: 99
          actor_login: "dev1"
          author_email: "dev1@example.com"
          author_name: "Dev1"
          is_distinct: true
          api_url: "http://api.github.com/repos/test/repo/commits/sha1"

  outputs:
    query:
      rows:
        - id: 1
          opendevdata_repo_id: 10
          sha1: "sha1"
          opendevdata_created_at: "2024-01-01 00:00:00"
          additions: 10
          deletions: 5
          authored_at: "2024-01-01 00:00:00"
          authored_at_offset: 0
          committed_at: "2024-01-01 00:00:00"
          committed_at_offset: 0
          commit_author_name: "Dev1"
          commit_author_email: "dev1@example.com"
          canonical_developer_id: 1
          is_bot: 0
          repo_id: 100
          github_repository_id: 1000
        - id: 2
          opendevdata_repo_id: 10
          sha1: "sha2"
          opendevdata_created_at: "2024-01-01 00:00:00"
          additions: 20
          deletions: 10
          authored_at: "2024-01-01 00:00:00"
          authored_at_offset: 0
          committed_at: "2024-01-01 00:00:00"
          committed_at_offset: 0
          commit_author_name: "Dev1"
          commit_author_email: "dev1@example.com"
          canonical_developer_id: 1
          is_bot: 0
          repo_id: 100
          github_repository_id: null
