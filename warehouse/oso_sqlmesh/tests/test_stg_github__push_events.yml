test_stg_github__push_events_basic:
  model: oso.stg_github__push_events
  vars:
    start_dt: 2024-01-01
    end_dt: 2024-01-02
  inputs:
    oso.stg_github__events:
      columns:
        id: text
        type: text
        created_at: timestamp(6)
        repo: STRUCT(id BIGINT, name VARCHAR, url VARCHAR)
        actor: STRUCT(id BIGINT, login VARCHAR, avatar_url VARCHAR, url VARCHAR)
        payload: text
      rows:
      - id: "event_1"
        type: "PushEvent"
        created_at: "2024-01-01 10:00:00.000000"
        repo:
          id: 101
          name: "owner/repo"
          url: "url"
        actor:
          id: 555
          login: "user1"
          avatar_url: "url"
          url: "url"
        payload: |
          {
            "push_id": 123,
            "ref": "refs/heads/main",
            "commits": [{"sha": "abc"}],
            "distinct_size": 1
          }
  outputs:
    query:
      rows:
      - created_at: "2024-01-01 10:00:00.000000"
        repository_id: 101
        repository_name: "owner/repo"
        actor_id: 555
        actor_login: "user1"
        push_id: "123"
        ref: "refs/heads/main"
        commits: '[{"sha":"abc"}]'
        available_commits_count: 1
        actual_commits_count: 1
