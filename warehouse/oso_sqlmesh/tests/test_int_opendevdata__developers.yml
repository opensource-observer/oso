test_int_opendevdata__developers_single_entry:
  model: oso.int_opendevdata__developers
  inputs:
    oso.stg_opendevdata__commits:
      columns:
        created_at: timestamp(6)
        authored_at: timestamp(6)
        committed_at: timestamp(6)
      rows:
        - canonical_developer_id: 101
          commit_author_name: "Open Dev"
          commit_author_email: "dev@open.com"
          committed_at: "2024-01-01 10:00:00.000000"
    oso.stg_opendevdata__canonical_developers:
      rows:
        - id: 101
          primary_github_user_id: "MDQ6VXNlcjEyMzQ1"
    oso.int_github__node_id_map:
      columns:
        node_id: varchar
        decoded_id: bigint
      rows:
        - node_id: "MDQ6VXNlcjEyMzQ1"
          decoded_id: 12345
  outputs:
    query:
      rows:
        - canonical_developer_id: 101
          primary_github_user_id: "MDQ6VXNlcjEyMzQ1"
          actor_id: 12345
          author_name: "Open Dev"
          author_email: "dev@open.com"
          author_synthetic_id: "f1e739cb553e5df92e1317f1d0ac3df2c1b4436b13c7e6d3440cc9fc1dba85ec"

test_int_opendevdata__developers_nextgen_nodeid:
  model: oso.int_opendevdata__developers
  inputs:
    oso.stg_opendevdata__commits:
      columns:
        created_at: timestamp(6)
        authored_at: timestamp(6)
        committed_at: timestamp(6)
      rows:
        - canonical_developer_id: 102
          commit_author_name: "NextGen Dev"
          commit_author_email: "nextgen@open.com"
          committed_at: "2024-01-01 10:00:00.000000"
    oso.stg_opendevdata__canonical_developers:
      rows:
        - id: 102
          primary_github_user_id: "U_kgDOAAGBzQ"
    oso.int_github__node_id_map:
      columns:
        node_id: varchar
        decoded_id: bigint
      rows:
        - node_id: "U_kgDOAAGBzQ"
          decoded_id: 98765
  outputs:
    query:
      rows:
        - canonical_developer_id: 102
          primary_github_user_id: "U_kgDOAAGBzQ"
          actor_id: 98765
          author_name: "NextGen Dev"
          author_email: "nextgen@open.com"
          author_synthetic_id: "90354a6883d979ada18f4055896cbada809a8802fed724d44bb71301a896c3a5"

test_int_opendevdata__developers_null_github_user_id:
  model: oso.int_opendevdata__developers
  inputs:
    oso.stg_opendevdata__commits:
      columns:
        created_at: timestamp(6)
        authored_at: timestamp(6)
        committed_at: timestamp(6)
      rows:
        - canonical_developer_id: 103
          commit_author_name: "No GitHub Dev"
          commit_author_email: "nogithub@open.com"
          committed_at: "2024-01-01 10:00:00.000000"
    oso.stg_opendevdata__canonical_developers:
      rows:
        - id: 103
          primary_github_user_id: null
    oso.int_github__node_id_map:
      columns:
        node_id: varchar
        decoded_id: bigint
      rows: []
  outputs:
    query:
      rows:
        - canonical_developer_id: 103
          primary_github_user_id: null
          actor_id: null
          author_name: "No GitHub Dev"
          author_email: "nogithub@open.com"
          author_synthetic_id: "36070ecda8c14c6e128153c997c0460af008dca4e1ee4d2d8c6643d50e8b29ac"

test_int_opendevdata__developers_takes_latest:
  model: oso.int_opendevdata__developers
  inputs:
    oso.stg_opendevdata__commits:
      columns:
        created_at: timestamp(6)
        authored_at: timestamp(6)
        committed_at: timestamp(6)
      rows:
        - canonical_developer_id: 202
          commit_author_name: "Original Name"
          commit_author_email: "original@test.com"
          committed_at: "2024-01-01 10:00:00.000000"
        - canonical_developer_id: 202
          commit_author_name: "New Name"
          commit_author_email: "original@test.com"
          committed_at: "2024-02-01 12:00:00.000000"
        - canonical_developer_id: 202
          commit_author_name: "Original Name"
          commit_author_email: "original@test.com"
          committed_at: "2024-01-15 10:00:00.000000"
    oso.stg_opendevdata__canonical_developers:
      rows:
        - id: 202
          primary_github_user_id: "MDQ6VXNlcjEyMzQ1"
    oso.int_github__node_id_map:
      columns:
        node_id: varchar
        decoded_id: bigint
      rows:
        - node_id: "MDQ6VXNlcjEyMzQ1"
          decoded_id: 12345
  outputs:
    query:
      rows:
        - canonical_developer_id: 202
          primary_github_user_id: "MDQ6VXNlcjEyMzQ1"
          actor_id: 12345
          author_name: "New Name"
          author_email: "original@test.com"
          author_synthetic_id: "0a1a2393c79d37c6d7001e3b29ce1aac9460c8ad33fba9d76916ad6b8ad42d12"

test_int_opendevdata__developers_filter_nulls:
  model: oso.int_opendevdata__developers
  inputs:
    oso.stg_opendevdata__commits:
      columns:
        created_at: timestamp(6)
        authored_at: timestamp(6)
        committed_at: timestamp(6)
      rows:
        - canonical_developer_id: null
          commit_author_name: "Ghost"
          commit_author_email: "ghost@test.com"
          committed_at: "2024-01-01 10:00:00.000000"
    oso.stg_opendevdata__canonical_developers:
      rows: []
    oso.int_github__node_id_map:
      columns:
        node_id: varchar
        decoded_id: bigint
      rows: []
  outputs:
    query:
      rows: []
