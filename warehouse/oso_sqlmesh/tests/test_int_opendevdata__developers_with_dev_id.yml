test_int_opendevdata__developers_with_dev_id_match:
  model: oso.int_opendevdata__developers_with_dev_id
  inputs:
    oso.int_gharchive__developers:
      columns:
        actor_id: bigint
        actor_login: varchar
        author_name: varchar
        author_email: varchar
        valid_from: timestamp
        valid_to: timestamp
      rows:
        - actor_id: 101
          actor_login: "dev1"
          author_name: "Match Dev"
          author_email: "match@test.com"
          valid_from: "2024-01-01 00:00:00"
          valid_to: "2024-02-01 00:00:00"
    oso.int_opendevdata__developers:
      columns:
        canonical_developer_id: bigint
        primary_github_user_id: varchar
        author_name: varchar
        author_email: varchar
        valid_from: timestamp
        valid_to: timestamp
      rows:
        - canonical_developer_id: 201
          primary_github_user_id: "gh_101"
          author_name: "Match Dev"
          author_email: "match@test.com"
          valid_from: "2024-01-15 00:00:00"
          valid_to: "2024-02-15 00:00:00"
  outputs:
    query:
      rows:
        - actor_id: 101
          actor_login: "dev1"
          canonical_developer_id: 201
          primary_github_user_id: "gh_101"
          author_name: "Match Dev"
          author_email: "match@test.com"
          valid_from: "2024-01-15 00:00:00"
          valid_to: "2024-02-01 00:00:00"

test_int_opendevdata__developers_with_dev_id_no_match:
  model: oso.int_opendevdata__developers_with_dev_id
  inputs:
    oso.int_gharchive__developers:
      columns:
        actor_id: bigint
        actor_login: varchar
        author_name: varchar
        author_email: varchar
        valid_from: timestamp
        valid_to: timestamp
      rows:
        - actor_id: 102
          actor_login: "dev2"
          author_name: "Github Only"
          author_email: "gh@test.com"
          valid_from: "2024-01-01 00:00:00"
          valid_to: null
    oso.int_opendevdata__developers:
      columns:
        canonical_developer_id: bigint
        primary_github_user_id: varchar
        author_name: varchar
        author_email: varchar
        valid_from: timestamp
        valid_to: timestamp
      rows:
        - canonical_developer_id: 202
          primary_github_user_id: "gh_202"
          author_name: "ODD Only"
          author_email: "odd@test.com"
          valid_from: "2024-01-01 00:00:00"
          valid_to: null
  outputs:
    query:
      rows:
        - actor_id: 102
          actor_login: "dev2"
          primary_github_user_id: null
          author_name: "Github Only"
          author_email: "gh@test.com"
          valid_from: "2024-01-01 00:00:00"
          valid_to: null
        - canonical_developer_id: 202
          actor_login: null
          primary_github_user_id: "gh_202"
          author_name: "ODD Only"
          author_email: "odd@test.com"
          valid_from: "2024-01-01 00:00:00"
          valid_to: null

test_int_opendevdata__developers_with_dev_id_no_overlap:
  model: oso.int_opendevdata__developers_with_dev_id
  inputs:
    oso.int_gharchive__developers:
      columns:
        actor_id: bigint
        actor_login: varchar
        author_name: varchar
        author_email: varchar
        valid_from: timestamp
        valid_to: timestamp
      rows:
        - actor_id: 103
          actor_login: "dev3"
          author_name: "Overlap Dev"
          author_email: "overlap@test.com"
          valid_from: "2024-01-01 00:00:00"
          valid_to: "2024-02-01 00:00:00"
    oso.int_opendevdata__developers:
      columns:
        canonical_developer_id: bigint
        primary_github_user_id: varchar
        author_name: varchar
        author_email: varchar
        valid_from: timestamp
        valid_to: timestamp
      rows:
        - canonical_developer_id: 203
          primary_github_user_id: "gh_103"
          author_name: "Overlap Dev"
          author_email: "overlap@test.com"
          valid_from: "2024-03-01 00:00:00"
          valid_to: "2024-04-01 00:00:00"
  outputs:
    query:
      rows:
        - actor_id: 103
          actor_login: "dev3"
          primary_github_user_id: null
          author_name: "Overlap Dev"
          author_email: "overlap@test.com"
          valid_from: "2024-01-01 00:00:00"
          valid_to: "2024-02-01 00:00:00"
        - canonical_developer_id: 203
          actor_login: null
          primary_github_user_id: "gh_103"
          author_name: "Overlap Dev"
          author_email: "overlap@test.com"
          valid_from: "2024-03-01 00:00:00"
          valid_to: "2024-04-01 00:00:00"
