type Dataset {
  id: ID!
  orgId: ID!
  name: String!
  displayName: String
  description: String
  type: DatasetType!
  creatorId: ID!
  isPublic: Boolean!
  createdAt: DateTime!
  updatedAt: DateTime!
  creator: User!
  organization: Organization!
  tables(first: Int = 50, after: String): TableConnection!

  """
  The runs for this dataset. For USER_MODEL datasets, each run is related to individual data models.
  FOR DATA_INGESTION datasets, each run is related to individual ingestion jobs.
  For DATA_CONNECTOR datasets, runs are not applicable and this field will be an empty list.
  """
  runs(first: Int = 50, after: String): RunConnection!

  typeDefinition: DatasetTypeDefinition!
}

union DatasetTypeDefinition = DataModelDefinition
  | DataIngestion
  | DataConnector

type DataModelDefinition {
  """
  If the dataset is of type USER_MODEL, this field will contain the list of data models
  associated with the dataset. Otherwise it will be an empty list.
  """
  dataModels(first: Int = 50, after: String): DataModelConnection!
}

type DatasetEdge {
  node: Dataset!
  cursor: String!
}

type DatasetConnection {
  edges: [DatasetEdge!]!
  pageInfo: PageInfo!
  totalCount: Int
}

type TableColumn {
  name: String!
  type: String!
  nullable: Boolean!
}

union TableSource = DataModel | DataIngestion | DataConnector

type Table {
  id: ID!
  datasetId: ID!
  catalogName: String!
  name: String!
  dataset: Dataset!
  columns: [TableColumn!]!
  source: TableSource!
}

type TableEdge {
  node: Table!
  cursor: String!
}

type TableConnection {
  edges: [TableEdge!]!
  pageInfo: PageInfo!
  totalCount: Int
}

extend type Query {
  """
  List all datasets
  """
  datasets(first: Int = 50, after: String): DatasetConnection!

  """
  Get a dataset by ID
  """
  dataset(id: ID!): Dataset

  """
  Get table column metadata
  """
  datasetTableMetadata(
    orgId: ID!
    catalogName: String!
    schemaName: String!
    tableName: String!
  ): [TableColumn!]!
}

extend type Mutation {
  """
  Create a new dataset
  """
  createDataset(input: CreateDatasetInput!): CreateDatasetPayload!

  """
  Update a dataset
  """
  updateDataset(input: UpdateDatasetInput!): UpdateDatasetPayload!
}

input CreateDatasetInput {
  orgId: ID!
  name: String!
  displayName: String
  description: String
  type: DatasetType = USER_MODEL
  isPublic: Boolean = false
}

type CreateDatasetPayload {
  success: Boolean!
  dataset: Dataset
  message: String
}

input UpdateDatasetInput {
  id: ID!
  name: String
  displayName: String
  description: String
  isPublic: Boolean
}

type UpdateDatasetPayload {
  success: Boolean!
  dataset: Dataset
  message: String
}
