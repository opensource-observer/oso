enum DataConnectionType {
  POSTGRESQL
  GSHEETS
  BIGQUERY
}

type DataConnection {
  id: ID!
  orgId: ID!
  organization: Organization!
  name: String!
  type: DataConnectionType!
  config: JSON!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type DataConnectionEdge {
  node: DataConnection!
  cursor: String!
}

type DataConnectionConnection {
  edges: [DataConnectionEdge!]!
  pageInfo: PageInfo!
  totalCount: Int
}

type DataConnectionAlias {
  id: ID!
  orgId: ID!
  datasetId: ID!
  dataConnectionId: ID!
  schema: String!
  modelContext(tableName: String!): ModelContext
  materializations(
    tableName: String!
    first: Int = 50
    after: String
    single: Boolean
    where: JSON
  ): MaterializationConnection!
  previewData(tableName: String!): [JSON!]!
}

extend type Query {
  """
  Query data connections with optional filtering and pagination.

  The where parameter accepts a JSON object with field-level filtering.
  Each field can have comparison operators: eq, neq, gt, gte, lt, lte, in, like, ilike, is
  """
  dataConnections(
    first: Int = 50
    after: String
    single: Boolean
    where: JSON
  ): DataConnectionConnection!
}

extend type Mutation {
  createDataConnection(
    input: CreateDataConnectionInput!
  ): CreateDataConnectionPayload!
  deleteDataConnection(id: ID!): SimplePayload!
  syncDataConnection(id: ID!): SyncDataConnectionPayload!
}

input CreateDataConnectionInput {
  orgId: ID!
  name: String!
  type: DataConnectionType!
  config: JSON!
  credentials: JSON!
}

type CreateDataConnectionPayload {
  success: Boolean!
  dataConnection: DataConnection
  message: String
}

type SyncDataConnectionPayload {
  success: Boolean!
  run: Run!
  message: String
}
