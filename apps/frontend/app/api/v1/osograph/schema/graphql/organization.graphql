type Organization {
  id: ID!
  name: String!
  displayName: String
  description: String
  createdAt: DateTime!
  updatedAt: DateTime!
  members(first: Int = 50, after: String): UserConnection!
  notebooks(first: Int = 50, after: String): NotebookConnection!
  datasets(first: Int = 50, after: String): DatasetConnection!
}

type OrganizationMember {
  id: ID!
  userId: ID!
  orgId: ID!
  userRole: MemberRole!
  createdAt: DateTime!
  user: User!
}

type OrganizationEdge {
  node: Organization!
  cursor: String!
}

type OrganizationConnection {
  edges: [OrganizationEdge!]!
  pageInfo: PageInfo!
  totalCount: Int
}

extend type Query {
  """
  List all organizations
  """
  organizations(first: Int = 50, after: String): OrganizationConnection!

  """
  Get an organization by ID or name
  """
  organization(id: ID, name: String): Organization
}

extend type Mutation {
  """
  Add a user to organization
  """
  addUserByEmail(input: AddUserByEmailInput!): AddUserByEmailPayload!

  """
  Remove a member from organization
  """
  removeMember(input: RemoveMemberInput!): RemoveMemberPayload!

  """
  Update member role
  """
  updateMemberRole(input: UpdateMemberRoleInput!): UpdateMemberRolePayload!
}

input AddUserByEmailInput {
  orgId: ID!
  email: String!
  role: MemberRole!
}

type AddUserByEmailPayload {
  success: Boolean!
  member: OrganizationMember
  message: String
}

input RemoveMemberInput {
  orgId: ID!
  userId: ID!
}

type RemoveMemberPayload {
  success: Boolean!
  message: String
}

input UpdateMemberRoleInput {
  orgId: ID!
  userId: ID!
  role: MemberRole!
}

type UpdateMemberRolePayload {
  success: Boolean!
  member: OrganizationMember
  message: String
}
